---
title: Diferenças entre scripts do Office e macros VBA
description: As diferenças de comportamento e API entre scripts do Office e macros VBA do Excel.
ms.date: 06/30/2020
localization_priority: Normal
ms.openlocfilehash: 8a8929f0c6a73a8e9041bb4b55cce1edd539e166
ms.sourcegitcommit: bf9f33c37c6f7805d6b408aa648bb9785a7cd133
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/06/2020
ms.locfileid: "45043388"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="820a9-103">Diferenças entre scripts do Office e macros VBA</span><span class="sxs-lookup"><span data-stu-id="820a9-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="820a9-104">Scripts do Office e macros do VBA têm muito em comum.</span><span class="sxs-lookup"><span data-stu-id="820a9-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="820a9-105">Ambos permitem que os usuários automatizem soluções por meio de um gravador de ação fácil de usar e permitir edições dessas gravações.</span><span class="sxs-lookup"><span data-stu-id="820a9-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="820a9-106">Ambas as estruturas foram projetadas para capacitar as pessoas que podem não considerar os programadores para criar pequenos programas no Excel.</span><span class="sxs-lookup"><span data-stu-id="820a9-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="820a9-107">A diferença fundamental é que as macros do VBA são desenvolvidas para soluções de área de trabalho e scripts do Office são projetadas com suporte e segurança entre plataformas como os princípios de orientação.</span><span class="sxs-lookup"><span data-stu-id="820a9-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed with cross-platform support and security as the guiding principles.</span></span> <span data-ttu-id="820a9-108">Atualmente, os scripts do Office só têm suporte no Excel na Web.</span><span class="sxs-lookup"><span data-stu-id="820a9-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

![Um diagrama de quatro quadrantes mostrando as áreas de foco para diferentes soluções de extensibilidade do Office.](../images/office-programmability-diagram.png)

<span data-ttu-id="820a9-111">Este artigo descreve as principais diferenças entre as macros VBA (bem como VBA em geral) e scripts do Office.</span><span class="sxs-lookup"><span data-stu-id="820a9-111">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="820a9-112">Como os scripts do Office estão disponíveis apenas para o Excel, esse é o único host abordado aqui.</span><span class="sxs-lookup"><span data-stu-id="820a9-112">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="820a9-113">Plataforma e ecossistema</span><span class="sxs-lookup"><span data-stu-id="820a9-113">Platform and ecosystem</span></span>

<span data-ttu-id="820a9-114">O VBA foi projetado para a área de trabalho e os scripts do Office foram projetados para a Web.</span><span class="sxs-lookup"><span data-stu-id="820a9-114">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="820a9-115">O VBA pode interagir com a área de trabalho de um usuário para se conectar com tecnologias semelhantes, como COM e OLE.</span><span class="sxs-lookup"><span data-stu-id="820a9-115">VBA can interact with a user's desktop to connect with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="820a9-116">No entanto, o VBA não tem uma maneira conveniente de fazer chamadas para a Internet.</span><span class="sxs-lookup"><span data-stu-id="820a9-116">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="820a9-117">Os scripts do Office usam um tempo de execução universal ou JavaScript.</span><span class="sxs-lookup"><span data-stu-id="820a9-117">Office Scripts use a universal runtime or JavaScript.</span></span> <span data-ttu-id="820a9-118">Isso fornece comportamento e acessibilidade consistentes, independentemente da máquina que está sendo usada para executar o script.</span><span class="sxs-lookup"><span data-stu-id="820a9-118">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="820a9-119">Eles também podem fazer chamadas para outros serviços Web.</span><span class="sxs-lookup"><span data-stu-id="820a9-119">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="820a9-120">Segurança</span><span class="sxs-lookup"><span data-stu-id="820a9-120">Security</span></span>

<span data-ttu-id="820a9-121">As macros do VBA têm o mesmo espaço livre de segurança que o Excel.</span><span class="sxs-lookup"><span data-stu-id="820a9-121">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="820a9-122">Isso lhes dá acesso total à sua área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="820a9-122">This gives them full access to your desktop.</span></span> <span data-ttu-id="820a9-123">Os scripts do Office só têm acesso à pasta de trabalho, não à máquina que hospeda a pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="820a9-123">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="820a9-124">Além disso, nenhum token de autenticação JavaScript pode ser compartilhado com scripts, de modo que os scripts nunca possam ser autenticados com um serviço externo.</span><span class="sxs-lookup"><span data-stu-id="820a9-124">Additionally, no JavaScript authentication tokens can be shared with scripts, so scripts can never authenticate with an external service.</span></span>

<span data-ttu-id="820a9-125">Os administradores têm três opções para macros VBA: permitir todas as macros no locatário, não permitir macros no locatário ou permitir somente macros com certificados assinados.</span><span class="sxs-lookup"><span data-stu-id="820a9-125">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="820a9-126">Essa falta de granularidade dificulta a isolação de um único ator ruim.</span><span class="sxs-lookup"><span data-stu-id="820a9-126">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="820a9-127">Atualmente, os scripts do Office estão ativados ou desativados para um locatário.</span><span class="sxs-lookup"><span data-stu-id="820a9-127">Currently, Office Scripts are either on or off for a tenant.</span></span> <span data-ttu-id="820a9-128">No entanto, estamos trabalhando para dar aos administradores mais controle sobre scripts individuais e criadores de scripts.</span><span class="sxs-lookup"><span data-stu-id="820a9-128">However, we are working to give admins more control over individual scripts and script creators.</span></span>

## <a name="coverage"></a><span data-ttu-id="820a9-129">Funcionamento</span><span class="sxs-lookup"><span data-stu-id="820a9-129">Coverage</span></span>

<span data-ttu-id="820a9-130">Atualmente, o VBA oferece uma cobertura mais completa dos recursos do Excel, particularmente aqueles disponíveis no cliente de desktop.</span><span class="sxs-lookup"><span data-stu-id="820a9-130">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="820a9-131">Os scripts do Office cobrem quase todos os cenários do Excel na Web.</span><span class="sxs-lookup"><span data-stu-id="820a9-131">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="820a9-132">Além disso, como novos recursos na Web, os scripts do Office oferecerão suporte para o gravador de ação e as APIs JavaScript.</span><span class="sxs-lookup"><span data-stu-id="820a9-132">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

## <a name="power-automate"></a><span data-ttu-id="820a9-133">Power Automate</span><span class="sxs-lookup"><span data-stu-id="820a9-133">Power Automate</span></span>

<span data-ttu-id="820a9-134">Os scripts do Office podem ser executados através da automatização de energia.</span><span class="sxs-lookup"><span data-stu-id="820a9-134">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="820a9-135">Sua pasta de trabalho pode ser atualizada por meio de fluxos agendados ou orientados por eventos, permitindo que você automatize fluxos de trabalho sem precisar abrir o Excel.</span><span class="sxs-lookup"><span data-stu-id="820a9-135">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="820a9-136">Isso significa que, desde que a pasta de trabalho seja armazenada no OneDrive (e acessível para automatização de energia), um fluxo pode executar seus scripts independentemente de você e sua organização usar a área de trabalho, Mac ou cliente Web do Excel.</span><span class="sxs-lookup"><span data-stu-id="820a9-136">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="820a9-137">O VBA não tem um conector automatizado de energia.</span><span class="sxs-lookup"><span data-stu-id="820a9-137">VBA doesn't have a Power Automate connector.</span></span> <span data-ttu-id="820a9-138">Todos os cenários de VBA suportados envolveram um usuário que participa da execução da macro.</span><span class="sxs-lookup"><span data-stu-id="820a9-138">All supported VBA scenarios involved a user attending to the macro's execution.</span></span>

## <a name="see-also"></a><span data-ttu-id="820a9-139">Confira também</span><span class="sxs-lookup"><span data-stu-id="820a9-139">See also</span></span>

- [<span data-ttu-id="820a9-140">Scripts do Office no Excel na Web</span><span class="sxs-lookup"><span data-stu-id="820a9-140">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="820a9-141">Diferenças entre os scripts do Office e os suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="820a9-141">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="820a9-142">Solução de problemas dos scripts do Office</span><span class="sxs-lookup"><span data-stu-id="820a9-142">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="820a9-143">Referência do VBA do Excel</span><span class="sxs-lookup"><span data-stu-id="820a9-143">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
