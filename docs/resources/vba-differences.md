---
title: Diferenças entre Office scripts e macros do VBA
description: O comportamento e as diferenças de API entre Office Scripts e Excel VBA.
ms.date: 05/21/2021
localization_priority: Normal
ms.openlocfilehash: c934b546834e018e5bac1da4d90043eb3bb52e63
ms.sourcegitcommit: 4693c8f79428ec74695328275703af0ba1bfea8f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53074414"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="60b22-103">Diferenças entre Office scripts e macros do VBA</span><span class="sxs-lookup"><span data-stu-id="60b22-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="60b22-104">Office Scripts e macros VBA têm muito em comum.</span><span class="sxs-lookup"><span data-stu-id="60b22-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="60b22-105">Ambos permitem que os usuários automatizem soluções por meio de um gravador de ações fácil de usar e permitem edições dessas gravações.</span><span class="sxs-lookup"><span data-stu-id="60b22-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="60b22-106">Ambas as estruturas foram projetadas para capacitar pessoas que podem não se considerar programadores para criar pequenos programas em Excel.</span><span class="sxs-lookup"><span data-stu-id="60b22-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="60b22-107">A diferença fundamental é que as macros VBA são desenvolvidas para soluções de área de trabalho e Office scripts são projetados para soluções seguras baseadas em nuvem.</span><span class="sxs-lookup"><span data-stu-id="60b22-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed for secure, cloud-based solutions.</span></span> <span data-ttu-id="60b22-108">Atualmente, Office scripts são suportados apenas em Excel na Web.</span><span class="sxs-lookup"><span data-stu-id="60b22-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Um diagrama de quatro quadrantes mostrando as áreas de foco para soluções Office extensibilidade diferentes. Tanto Office scripts quanto macros VBA foram projetados para ajudar os usuários finais a criar soluções, mas Office scripts são criados para a Web e colaboração (enquanto o VBA é para a área de trabalho).":::

<span data-ttu-id="60b22-110">Este artigo descreve as principais diferenças entre as macros do VBA (bem como o VBA em geral) e Office Scripts.</span><span class="sxs-lookup"><span data-stu-id="60b22-110">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="60b22-111">Como Office scripts estão disponíveis apenas para Excel, esse é o único host que está sendo discutido aqui.</span><span class="sxs-lookup"><span data-stu-id="60b22-111">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="60b22-112">Plataforma e ecossistema</span><span class="sxs-lookup"><span data-stu-id="60b22-112">Platform and ecosystem</span></span>

<span data-ttu-id="60b22-113">O VBA foi projetado para a área de trabalho e Office scripts foram projetados para a Web.</span><span class="sxs-lookup"><span data-stu-id="60b22-113">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="60b22-114">O VBA pode interagir com a área de trabalho de um usuário para se conectar com tecnologias semelhantes, como COM e OLE.</span><span class="sxs-lookup"><span data-stu-id="60b22-114">VBA can interact with a user's desktop to connect with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="60b22-115">No entanto, o VBA não tem uma maneira conveniente de chamar a Internet.</span><span class="sxs-lookup"><span data-stu-id="60b22-115">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="60b22-116">Office Scripts usam um tempo de execução universal para JavaScript.</span><span class="sxs-lookup"><span data-stu-id="60b22-116">Office Scripts use a universal runtime for JavaScript.</span></span> <span data-ttu-id="60b22-117">Isso oferece comportamento e acessibilidade consistentes, independentemente do computador que está sendo usado para executar o script.</span><span class="sxs-lookup"><span data-stu-id="60b22-117">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="60b22-118">Eles também podem fazer chamadas para outros serviços Web.</span><span class="sxs-lookup"><span data-stu-id="60b22-118">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="60b22-119">Segurança</span><span class="sxs-lookup"><span data-stu-id="60b22-119">Security</span></span>

<span data-ttu-id="60b22-120">As macros VBA têm a mesma autorização de segurança que Excel.</span><span class="sxs-lookup"><span data-stu-id="60b22-120">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="60b22-121">Isso dá a eles acesso total à sua área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="60b22-121">This gives them full access to your desktop.</span></span> <span data-ttu-id="60b22-122">Office Os scripts só têm acesso à workbook, não ao computador que hospeda a workbook.</span><span class="sxs-lookup"><span data-stu-id="60b22-122">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="60b22-123">Além disso, nenhum token de autenticação JavaScript pode ser compartilhado com scripts.</span><span class="sxs-lookup"><span data-stu-id="60b22-123">Additionally, no JavaScript authentication tokens can be shared with scripts.</span></span> <span data-ttu-id="60b22-124">Isso significa que o script não tem os tokens do usuário interno nem há recursos de API para entrar em um serviço externo, portanto, eles não podem usar tokens existentes para fazer chamadas externas em nome do usuário.</span><span class="sxs-lookup"><span data-stu-id="60b22-124">This means the script has neither the tokens of the signed-in user nor are there any API capabilities for signing in to an external service, so they are unable to use existing tokens to make external calls on behalf of the user.</span></span>

<span data-ttu-id="60b22-125">Os administradores têm três opções para macros VBA: permitir todas as macros no locatário, não permitir macros no locatário ou permitir somente macros com certificados assinados.</span><span class="sxs-lookup"><span data-stu-id="60b22-125">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="60b22-126">Essa falta de granularidade dificulta a isolação de um único ator ruim.</span><span class="sxs-lookup"><span data-stu-id="60b22-126">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="60b22-127">Atualmente, Office scripts podem estar desligados para um locatário inteiro, para um locatário inteiro ou para um grupo de usuários em um locatário.</span><span class="sxs-lookup"><span data-stu-id="60b22-127">Currently, Office Scripts can be off for an entire tenant, on for an entire tenant, or on for a group of users in a tenant.</span></span> <span data-ttu-id="60b22-128">Os administradores também têm controle sobre quem pode compartilhar scripts com outras pessoas e quem pode usar scripts em Power Automate.</span><span class="sxs-lookup"><span data-stu-id="60b22-128">Admins also have control over who can share scripts with others and who can use scripts in Power Automate.</span></span>

## <a name="coverage"></a><span data-ttu-id="60b22-129">Cobertura</span><span class="sxs-lookup"><span data-stu-id="60b22-129">Coverage</span></span>

<span data-ttu-id="60b22-130">Atualmente, o VBA oferece uma cobertura mais completa de recursos Excel, especialmente aqueles disponíveis no cliente da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="60b22-130">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="60b22-131">Office Os scripts abrangem quase todos os cenários para Excel na Web.</span><span class="sxs-lookup"><span data-stu-id="60b22-131">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="60b22-132">Além disso, à medida que novos recursos estream na Web, os scripts Office os darão suporte para as APIs Action Recorder e JavaScript.</span><span class="sxs-lookup"><span data-stu-id="60b22-132">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

<span data-ttu-id="60b22-133">Office Scripts não suportam eventos Excel [nível](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects).</span><span class="sxs-lookup"><span data-stu-id="60b22-133">Office Scripts don't support Excel-level [events](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects).</span></span> <span data-ttu-id="60b22-134">Os scripts só são executados quando um usuário os inicia manualmente ou quando um fluxo Power Automate chama o script.</span><span class="sxs-lookup"><span data-stu-id="60b22-134">Scripts are only run when a user manually starts them or when a Power Automate flow calls the script.</span></span>

## <a name="power-automate"></a><span data-ttu-id="60b22-135">Power Automate</span><span class="sxs-lookup"><span data-stu-id="60b22-135">Power Automate</span></span>

<span data-ttu-id="60b22-136">Office Os scripts podem ser executados Power Automate.</span><span class="sxs-lookup"><span data-stu-id="60b22-136">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="60b22-137">Sua workbook pode ser atualizada por meio de fluxos agendados ou orientados por eventos, o que permite automatizar fluxos de trabalho sem nem mesmo abrir Excel.</span><span class="sxs-lookup"><span data-stu-id="60b22-137">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="60b22-138">Isso significa que, desde que sua OneDrive seja armazenada no OneDrive (e acessível ao Power Automate), um fluxo pode executar seus scripts independentemente de você e sua organização usarem a área de trabalho, Mac ou cliente Web do Excel.</span><span class="sxs-lookup"><span data-stu-id="60b22-138">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="60b22-139">O VBA não tem um Power Automate conector.</span><span class="sxs-lookup"><span data-stu-id="60b22-139">VBA doesn't have a Power Automate connector.</span></span> <span data-ttu-id="60b22-140">Todos os cenários do VBA com suporte envolvem um usuário que está participando da execução da macro.</span><span class="sxs-lookup"><span data-stu-id="60b22-140">All supported VBA scenarios involve a user attending to the macro's execution.</span></span>

<span data-ttu-id="60b22-141">Experimente os [scripts de chamada de um tutorial de Power Automate de fluxo](../tutorials/excel-power-automate-manual.md) manual para começar a aprender sobre Power Automate.</span><span class="sxs-lookup"><span data-stu-id="60b22-141">Try the [Call scripts from a manual Power Automate flow](../tutorials/excel-power-automate-manual.md) tutorial to start learning about Power Automate.</span></span> <span data-ttu-id="60b22-142">Você também pode verificar o exemplo de lembretes de tarefas [automatizados](scenarios/task-reminders.md) para ver Office scripts conectados Teams a Power Automate em um cenário real.</span><span class="sxs-lookup"><span data-stu-id="60b22-142">You can also check out the [Automated task reminders](scenarios/task-reminders.md) sample to see Office Scripts connected to Teams through Power Automate in a real-world scenario.</span></span>

## <a name="see-also"></a><span data-ttu-id="60b22-143">Confira também</span><span class="sxs-lookup"><span data-stu-id="60b22-143">See also</span></span>

- [<span data-ttu-id="60b22-144">Scripts do Office no Excel na Web</span><span class="sxs-lookup"><span data-stu-id="60b22-144">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="60b22-145">Executar Office scripts com Power Automate</span><span class="sxs-lookup"><span data-stu-id="60b22-145">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="60b22-146">Diferenças entre os scripts do Office e os suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="60b22-146">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="60b22-147">Solução de problemas dos scripts do Office</span><span class="sxs-lookup"><span data-stu-id="60b22-147">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="60b22-148">Referência do VBA do Excel</span><span class="sxs-lookup"><span data-stu-id="60b22-148">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
