---
title: Solucionar Office scripts em execução no Power Automate
description: Dicas, informações da plataforma e problemas conhecidos com a integração entre Office Scripts e Power Automate.
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 7ba128314c0d632a3e77792b7ee545bfb7dca71d
ms.sourcegitcommit: 4693c8f79428ec74695328275703af0ba1bfea8f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53074631"
---
# <a name="troubleshoot-office-scripts-running-in-power-automate"></a><span data-ttu-id="ef3a7-103">Solucionar Office scripts em execução no Power Automate</span><span class="sxs-lookup"><span data-stu-id="ef3a7-103">Troubleshoot Office Scripts running in Power Automate</span></span>

<span data-ttu-id="ef3a7-104">Power Automate permite que você leve sua automação Office Script para o próximo nível.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="ef3a7-105">No entanto, como Power Automate executa scripts em seu nome em sessões Excel independentes, há algumas coisas importantes a observar.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="ef3a7-106">Se você estiver apenas começando a usar Office scripts com Power Automate, comece com [Executar scripts](../develop/power-automate-integration.md) Office com Power Automate para saber mais sobre as plataformas.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-relative-references"></a><span data-ttu-id="ef3a7-107">Evitar referências relativas</span><span class="sxs-lookup"><span data-stu-id="ef3a7-107">Avoid relative references</span></span>

<span data-ttu-id="ef3a7-108">Power Automate executa seu script na Excel de trabalho escolhida em seu nome.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="ef3a7-109">A workbook pode ser fechada quando isso acontece.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="ef3a7-110">Qualquer API que se basei no estado atual do usuário, como , pode se comportar de forma `Workbook.getActiveWorksheet` diferente Power Automate.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="ef3a7-111">Isso porque as APIs se baseiam em uma posição relativa do cursor ou exibição do usuário e essa referência não existe em um fluxo Power Automate usuário.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="ef3a7-112">Algumas APIs de referência relativa lançam erros Power Automate.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="ef3a7-113">Outras têm um comportamento padrão que implica no estado de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="ef3a7-114">Ao projetar seus scripts, certifique-se de usar referências absolutas para planilhas e intervalos.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="ef3a7-115">Isso torna o fluxo Power Automate consistente, mesmo que as planilhas sejam reorganizadas.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-in-power-automate-flows"></a><span data-ttu-id="ef3a7-116">Métodos de script que falham quando executados em Power Automate fluxos</span><span class="sxs-lookup"><span data-stu-id="ef3a7-116">Script methods that fail when run in Power Automate flows</span></span>

<span data-ttu-id="ef3a7-117">Os métodos a seguir lançam um erro e falham quando chamados de um script em Power Automate fluxo.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-117">The following methods throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="ef3a7-118">Classe</span><span class="sxs-lookup"><span data-stu-id="ef3a7-118">Class</span></span> | <span data-ttu-id="ef3a7-119">Método</span><span class="sxs-lookup"><span data-stu-id="ef3a7-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="ef3a7-120">Gráfico</span><span class="sxs-lookup"><span data-stu-id="ef3a7-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="ef3a7-121">Range</span><span class="sxs-lookup"><span data-stu-id="ef3a7-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="ef3a7-122">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="ef3a7-123">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="ef3a7-124">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="ef3a7-125">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="ef3a7-126">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="ef3a7-127">Métodos de script com um comportamento padrão em fluxos Power Automate fluxos</span><span class="sxs-lookup"><span data-stu-id="ef3a7-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="ef3a7-128">Os métodos a seguir usam um comportamento padrão, em vez do estado atual de qualquer usuário.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="ef3a7-129">Classe</span><span class="sxs-lookup"><span data-stu-id="ef3a7-129">Class</span></span> | <span data-ttu-id="ef3a7-130">Método</span><span class="sxs-lookup"><span data-stu-id="ef3a7-130">Method</span></span> | <span data-ttu-id="ef3a7-131">Power Automate comportamento</span><span class="sxs-lookup"><span data-stu-id="ef3a7-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="ef3a7-132">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="ef3a7-133">Retorna a primeira planilha da pasta de trabalho ou a planilha atualmente ativada pelo `Worksheet.activate` método.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="ef3a7-134">Planilha</span><span class="sxs-lookup"><span data-stu-id="ef3a7-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="ef3a7-135">Marca a planilha como a planilha ativa para fins de `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="ef3a7-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="data-refresh-not-supported-in-power-automate"></a><span data-ttu-id="ef3a7-136">Atualização de dados não suportada em Power Automate</span><span class="sxs-lookup"><span data-stu-id="ef3a7-136">Data refresh not supported in Power Automate</span></span>

<span data-ttu-id="ef3a7-137">Office Os scripts não podem atualizar dados quando executados Power Automate.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-137">Office Scripts can't refresh data when run in Power Automate.</span></span> <span data-ttu-id="ef3a7-138">Métodos como `PivotTable.refresh` não fazer nada quando chamado em um fluxo.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-138">Methods such as `PivotTable.refresh` do nothing when called in a flow.</span></span> <span data-ttu-id="ef3a7-139">Além disso, Power Automate não dispara uma atualização de dados para fórmulas que usam links de workbook.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-139">Additionally, Power Automate doesn't trigger a data refresh for formulas that use workbook links.</span></span>

### <a name="script-methods-that-do-nothing-when-run-in-power-automate-flows"></a><span data-ttu-id="ef3a7-140">Métodos de script que não fazem nada quando executados Power Automate fluxos</span><span class="sxs-lookup"><span data-stu-id="ef3a7-140">Script methods that do nothing when run in Power Automate flows</span></span>

<span data-ttu-id="ef3a7-141">Os métodos a seguir não fazem nada em um script quando chamados por Power Automate.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-141">The following methods do nothing in a script when called through Power Automate.</span></span> <span data-ttu-id="ef3a7-142">Eles ainda retornam com êxito e não lançam erros.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-142">They still return successfully and don't throw any errors.</span></span>

| <span data-ttu-id="ef3a7-143">Classe</span><span class="sxs-lookup"><span data-stu-id="ef3a7-143">Class</span></span> | <span data-ttu-id="ef3a7-144">Método</span><span class="sxs-lookup"><span data-stu-id="ef3a7-144">Method</span></span> |
|--|--|
| [<span data-ttu-id="ef3a7-145">PivotTable</span><span class="sxs-lookup"><span data-stu-id="ef3a7-145">PivotTable</span></span>](/javascript/api/office-scripts/excelscript/excelscript.pivottable) | `refresh` |
| [<span data-ttu-id="ef3a7-146">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-146">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `refreshAllDataConnections` |
| [<span data-ttu-id="ef3a7-147">Pasta de trabalho</span><span class="sxs-lookup"><span data-stu-id="ef3a7-147">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `refreshAllPivotTables` |
| [<span data-ttu-id="ef3a7-148">Planilha</span><span class="sxs-lookup"><span data-stu-id="ef3a7-148">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `refreshAllPivotTables` |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="ef3a7-149">Selecionar pasta de trabalho com o controle do navegador de arquivos</span><span class="sxs-lookup"><span data-stu-id="ef3a7-149">Select workbooks with the file browser control</span></span>

<span data-ttu-id="ef3a7-150">Ao criar a **etapa Executar script** de um fluxo Power Automate, você precisa selecionar qual workbook faz parte do fluxo.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-150">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="ef3a7-151">Use o navegador de arquivos para selecionar sua pasta de trabalho, em vez de digitar manualmente o nome da pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-151">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="A Power Automate executar script mostrando a opção Mostrar navegador de arquivo do Se picker.":::

<span data-ttu-id="ef3a7-153">Para obter mais contexto sobre a limitação Power Automate e uma discussão sobre possíveis soluções alternativas para a seleção dinâmica de workbooks, consulte este thread no [Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span><span class="sxs-lookup"><span data-stu-id="ef3a7-153">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="ef3a7-154">Diferenças de fuso horário</span><span class="sxs-lookup"><span data-stu-id="ef3a7-154">Time zone differences</span></span>

<span data-ttu-id="ef3a7-155">Excel arquivos não têm um local ou zona de tempo inerente.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-155">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="ef3a7-156">Sempre que um usuário abre a workbook, sua sessão usa o período de tempo local desse usuário para cálculos de data.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-156">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="ef3a7-157">Power Automate sempre usa UTC.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-157">Power Automate always uses UTC.</span></span>

<span data-ttu-id="ef3a7-158">Se o script usa datas ou horas, pode haver diferenças comportamentais quando o script é testado localmente em comparação com quando ele é executado por Power Automate.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-158">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="ef3a7-159">Power Automate permite converter, formatar e ajustar tempos.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-159">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="ef3a7-160">Consulte Trabalhando com Datas e [Horas](https://flow.microsoft.com/blog/working-with-dates-and-times/) dentro de seus fluxos para obter instruções sobre como usar essas funções no Power Automate [ `main` e Parâmetros:](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) Passar dados para um script para saber como fornecer essas informações de tempo para o script.</span><span class="sxs-lookup"><span data-stu-id="ef3a7-160">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Pass data to a script](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="ef3a7-161">Confira também</span><span class="sxs-lookup"><span data-stu-id="ef3a7-161">See also</span></span>

- [<span data-ttu-id="ef3a7-162">Solucionar Office scripts</span><span class="sxs-lookup"><span data-stu-id="ef3a7-162">Troubleshoot Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="ef3a7-163">Executar Office scripts com Power Automate</span><span class="sxs-lookup"><span data-stu-id="ef3a7-163">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="ef3a7-164">Excel Documentação de referência do conector Online (Business)</span><span class="sxs-lookup"><span data-stu-id="ef3a7-164">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
